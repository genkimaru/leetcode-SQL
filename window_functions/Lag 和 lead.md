
## LAG 和 LEAD 的用法

* 原始数据
```sql
mysql> select num , id  from test;
+------+------+
| num  | id   |
+------+------+
|    1 |    1 |
|    1 |    2 |
|    1 |    3 |
|    2 |    4 |
|    1 |    5 |
|    2 |    6 |
|    2 |    7 |
+------+------+

```

* LAG(column_name , 落后的行数，默认值)
``` sql
select num , id , lag(id , 1 , 999) over(order by id ) id_lag from test;
+------+------+--------+
| num  | id   | id_lag |
+------+------+--------+
|    1 |    1 |    999 |
|    1 |    2 |      1 |
|    1 |    3 |      2 |
|    2 |    4 |      3 |
|    1 |    5 |      4 |
|    2 |    6 |      5 |
|    2 |    7 |      6 |
+------+------+--------+

```


* LEAD(column_name , 领先的行数，默认值)
```sql 
mysql> select num , id , lead(id , 1 , 999) over(order by id ) id_lead from test
;
+------+------+---------+
| num  | id   | id_lead |
+------+------+---------+
|    1 |    1 |       2 |
|    1 |    2 |       3 |
|    1 |    3 |       4 |
|    2 |    4 |       5 |
|    1 |    5 |       6 |
|    2 |    6 |       7 |
|    2 |    7 |     999 |
+------+------+---------+
```
